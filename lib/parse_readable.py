# encoding: utf8

import os, sys, logging

"""
using following 3 tools via os.system
- floss       # Mandiant obfuscate string detection tool:flare-floss
- strings     # for ascess
- strings -el # for unicode
"""

logger = logging.getLogger(__name__)

STRINGS_ASCII   = "strings_ascii.txt"
STRINGS_UNICODE = "strings_unicode.txt"
FLOSS = "floss.txt"

def write_readablestring(file_name, output_dir):
    logger.info("start check readable strings for {}".format(file_name))
    com = "strings -a {} > {}/{}".format(
            file_name, output_dir, STRINGS_ASCII)
    logger.debug("execute command -> {}".format(com))
    os.system(com)
    com = "strings -a -el {} > {}/{}".format(
            file_name, output_dir, STRINGS_UNICODE)
    logger.debug("execute command -> {}".format(com))
    os.system(com)
    com = "floss {} > {}/{}".format(
            file_name, output_dir, FLOSS)
    logger.debug("execute command -> {}".format(com))
    os.system(com)
    logger.info("finish to check")

