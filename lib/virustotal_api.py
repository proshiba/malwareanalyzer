# encoding: utf8

import os, sys
import vt

API_KEY = None

def getinfo_by_hash(filehash):
    info = to_query("get_info", queryname="hash", queryvalue=filehash)
    info["exist"] = info["query_status"] == "ok"
    return info

def to_query(querytype, queryname, queryvalue):
    assert isinstance(API_KEY, str), "you must set API_KEY previously using. <thismodule>.API_KEY=<Your API KEY write here>"
    data = { "query" : querytype, queryname : queryvalue }
    if isinstance(limit, int):
        data["limit"] = limit
    res = requests.post(URL, headers={"API_KEY" : API_KEY}, data=data)
    info = res.json()
    return {"query_status" : info["query_status"],
            "status_code"  : res.status_code,
            "data"         : info,
            "response"     : res }

