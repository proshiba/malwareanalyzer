# encoding: utf8

import os, sys, logging
import pefile, ssdeep, hashlib, magic
from pathlib import Path

logger = logging.getLogger(__name__)

def get_hashinfo(data):
	logger.debug("calc secure hash information")
	return [
		{"type" : "md5",    "value" : hashlib.md5(data).hexdigest()   },
		{"type" : "sha1",   "value" : hashlib.sha1(data).hexdigest()  },
		{"type" : "sha256", "value" : hashlib.sha256(data).hexdigest()}
	]

def get_baseinfo(file_name, data):
	logger.debug("parse base file information")
	magicinfo = magic.detect_from_content(data)

	mime_type = magicinfo.mime_type
	fencoding = magicinfo.encoding
	file_type = magicinfo.name
	file_size = Path(file_name).stat().st_size

def parse_info(file_name):
	results = []
	data = open(file_name, "rb").read()
	baseinfo = get_baseinfo(file_name, data)
	hashinfo = get_hashinfo(data)
	results.append({ "hashes" : hashinfo })
